<form class="row g-2 mb-3" method="get" action="/admin/users">
  <div class="col-auto">
    <input class="form-control form-control-sm" type="text" name="q" placeholder="Поиск по ID/имени/@username" value="<%= q || '' %>">
  </div>
  <div class="col-auto">
    <button class="btn btn-sm btn-outline-primary">Поиск</button>
  </div>
  <div class="col-auto">
    <select name="status" class="form-select form-select-sm">
      <option value="">Все</option>
      <option value="active" <%= status === 'active' ? 'selected' : '' %>>Активные</option>
      <option value="inactive" <%= status === 'inactive' ? 'selected' : '' %>>Неактивные</option>
    </select>
  </div>
</form>

<div class="card shadow-sm">
  <div class="card-header bg-primary text-white">
    <h5 class="mb-0">Пользователи</h5>
  </div>
  <div class="card-body p-0">
    <div class="table-responsive">
      <table class="table table-hover mb-0 align-middle">
        <thead class="table-light">
          <tr>
            <th>ID</th>
            <th>Имя</th>
            <th>Username</th>
            <th>Лимит</th>
            <th>Скачано всего</th>
            <th>Активность</th>
            <th>Действия</th>
          </tr>
        </thead>
        <tbody>
          <% if (!users || users.length === 0) { %>
            <tr>
              <td colspan="7" class="text-center text-muted py-4">Ничего не найдено</td>
            </tr>
          <% } else { %>
            <% users.forEach(u => { %>
              <tr class="table-hover-row">
                <td><%= u.id %></td>
                <td><%= u.first_name || 'Не указано' %></td>
                <td><%= u.username ? '@'+u.username : 'Не указано' %></td>
                <td class="text-center"><%= u.premium_limit || '—' %></td>
                <td class="text-center"><%= u.total_downloads || 0 %></td>
                <td class="text-center">
                  <%= u.last_active
                        ? new Date(String(u.last_active).replace(' ','T')+'Z').toLocaleString('ru-RU')
                        : '—' %>
                </td>
                <td class="text-center">
                  <a class="btn btn-sm btn-outline-primary" href="/user/<%= u.id %>">Открыть</a>
                  <form method="post" action="/admin/users/<%= u.id %>/tariff" class="d-inline-block">
                    <select name="limit" class="form-select form-select-sm">
                      <option value="5">Free</option>
                      <option value="30">Plus</option>
                      <option value="100">Pro</option>
                      <option value="1000">Unlimited</option>
                    </select>
                    <button class="btn btn-sm btn-outline-primary mt-2">Сменить тариф</button>
                  </form>
                </td>
              </tr>
            <% }) %>
          <% } %>
        </tbody>
      </table>
    </div>
  </div>
</div>

<!-- Стиль для таблицы -->
<style>
  .table-hover-row:hover {
    background-color: #f0f8ff;
  }

  .table thead th {
    background-color: #007bff;
    color: white;
  }

  .card-header {
    background-color: #007bff;
    color: white;
    font-weight: bold;
  }
</style>